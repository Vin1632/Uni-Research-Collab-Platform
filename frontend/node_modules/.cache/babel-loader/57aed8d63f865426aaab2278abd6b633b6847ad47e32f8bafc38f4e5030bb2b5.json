{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import Header from\"../components/Header\";import'../styles/Dashboard.css';import{FaImage,FaFlag}from\"react-icons/fa\";// ✅ Added FaFlag icon\nimport{get_project_data}from\"../services/proposal_service\";import{flag_project}from\"../services/proposal_service\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Dashboard(){const navigate=useNavigate();const[proposals,setProposal]=useState([]);const[user_id,setuser_id]=useState();useEffect(()=>{if(!user_id){console.log(\"User-Id not here\");return;}const fetchProjects=async()=>{try{const project_dat=await get_project_data(user_id);setProposal(project_dat[0]);}catch(err){console.error(\"Failed to fetch Projects\",err);}};fetchProjects();console.log(\"User ID is:\",user_id);},[user_id]);return/*#__PURE__*/_jsxs(\"main\",{className:\"dashboard-wrapper\",children:[/*#__PURE__*/_jsx(Header,{onUser_IdLoaded:setuser_id}),/*#__PURE__*/_jsx(\"section\",{className:\"dashboard-container\",children:proposals.map(proposal=>/*#__PURE__*/_jsx(ProposalCard,{proposal:proposal,user_id:user_id,onClick:()=>navigate(\"/project_details/\",{state:{project_id:proposal.project_id}})},proposal.project_id))})]});}function ProposalCard(_ref){let{proposal,onClick,user_id}=_ref;const[imgError,setImgError]=useState(false);const[showFlagModal,setShowFlagModal]=useState(false);const[flagReason,setFlagReason]=useState(\"\");const[flagDesc,setFlagDesc]=useState(\"\");const[flagged,setFlagged]=useState(false);const handleFlag=async()=>{if(!flagReason)return alert(\"Please select a reason.\");try{if(!user_id){alert(\"User ID not loaded. Please try again later.\");return;}await flag_project(proposal.project_id,user_id,flagReason,flagDesc);setFlagged(true);setShowFlagModal(false);}catch(err){alert(\"Failed to flag project.\");console.error(err);}};const isImageValid=proposal.link_image&&proposal.link_image.trim()!==\"\"&&!imgError;return/*#__PURE__*/_jsxs(\"article\",{className:\"proposal-card\",children:[/*#__PURE__*/_jsxs(\"div\",{onClick:onClick,children:[isImageValid?/*#__PURE__*/_jsx(\"img\",{src:proposal.link_image,onError:()=>{console.warn(\"Image failed to load:\",proposal.link_image);setImgError(true);},alt:proposal.title,className:\"proposal-image\"}):/*#__PURE__*/_jsx(\"div\",{className:\"proposal-image fallback-icon\",children:/*#__PURE__*/_jsx(FaImage,{size:48,color:\"#aaa\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"proposal-title\",children:proposal.title}),/*#__PURE__*/_jsx(\"p\",{className:\"proposal-summary\",children:proposal.description})]}),/*#__PURE__*/_jsx(\"button\",{className:\"flag-btn\",onClick:()=>setShowFlagModal(true),disabled:flagged,children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FaFlag,{style:{marginRight:\"6px\",color:flagged?\"red\":\"#333\"}}),flagged?\"Flagged\":\"Flag\"]})}),showFlagModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Flag Project\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Reason:\"}),/*#__PURE__*/_jsxs(\"select\",{value:flagReason,onChange:e=>setFlagReason(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select reason\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Inappropriate Content\",children:\"Inappropriate Content\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Spam\",children:\"Spam\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Other\",children:\"Other\"})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Description (optional):\"}),/*#__PURE__*/_jsx(\"textarea\",{value:flagDesc,onChange:e=>setFlagDesc(e.target.value),rows:\"3\",placeholder:\"Describe why you're flagging this project...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleFlag,children:\"Submit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowFlagModal(false),children:\"Cancel\"})]})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","Header","FaImage","FaFlag","get_project_data","flag_project","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Dashboard","navigate","proposals","setProposal","user_id","setuser_id","console","log","fetchProjects","project_dat","err","error","className","children","onUser_IdLoaded","map","proposal","ProposalCard","onClick","state","project_id","_ref","imgError","setImgError","showFlagModal","setShowFlagModal","flagReason","setFlagReason","flagDesc","setFlagDesc","flagged","setFlagged","handleFlag","alert","isImageValid","link_image","trim","src","onError","warn","alt","title","size","color","description","disabled","style","marginRight","value","onChange","e","target","required","rows","placeholder"],"sources":["C:/Users/pc/Desktop/recent/frontend/src/pages/recommendations.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Header from \"../components/Header\";\r\nimport '../styles/Dashboard.css';\r\n\r\nimport { FaImage, FaFlag } from \"react-icons/fa\"; // ✅ Added FaFlag icon\r\nimport { get_project_data } from \"../services/proposal_service\";\r\nimport { flag_project } from \"../services/proposal_service\";\r\n\r\nexport default function Dashboard() {\r\n  const navigate = useNavigate();\r\n  const [proposals, setProposal] = useState([]);\r\n  const [user_id, setuser_id] = useState();\r\n\r\n  useEffect(() => {\r\n    if (!user_id) {\r\n      console.log(\"User-Id not here\");\r\n      return;\r\n    }\r\n\r\n    const fetchProjects = async () => {\r\n      try {\r\n        const project_dat = await get_project_data(user_id);\r\n        setProposal(project_dat[0]);\r\n      } catch (err) {\r\n        console.error(\"Failed to fetch Projects\", err);\r\n      }\r\n    };\r\n\r\n    fetchProjects();\r\n    console.log(\"User ID is:\", user_id);\r\n  }, [user_id]);\r\n\r\n  return (\r\n    <main className=\"dashboard-wrapper\">\r\n      <Header onUser_IdLoaded={setuser_id} />\r\n\r\n      <section className=\"dashboard-container\">\r\n        {proposals.map(proposal => (\r\n          <ProposalCard\r\n            key={proposal.project_id}\r\n            proposal={proposal}\r\n            user_id={user_id}\r\n            onClick={() => navigate(`/project_details/`, { state: { project_id: proposal.project_id } })}\r\n          />\r\n        ))}\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n\r\nfunction ProposalCard({ proposal, onClick, user_id }) {\r\n  const [imgError, setImgError] = useState(false);\r\n  const [showFlagModal, setShowFlagModal] = useState(false);\r\n  const [flagReason, setFlagReason] = useState(\"\");\r\n  const [flagDesc, setFlagDesc] = useState(\"\");\r\n  const [flagged, setFlagged] = useState(false);\r\n\r\n  const handleFlag = async () => {\r\n    if (!flagReason) return alert(\"Please select a reason.\");\r\n    try {\r\n      if (!user_id) {\r\n        alert(\"User ID not loaded. Please try again later.\");\r\n        return;\r\n      }\r\n      await flag_project(proposal.project_id, user_id, flagReason, flagDesc);\r\n      setFlagged(true);\r\n      setShowFlagModal(false);\r\n    } catch (err) {\r\n      alert(\"Failed to flag project.\");\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const isImageValid = proposal.link_image && proposal.link_image.trim() !== \"\" && !imgError;\r\n\r\n  return (\r\n    <article className=\"proposal-card\">\r\n      <div onClick={onClick}>\r\n        {isImageValid ? (\r\n          <img\r\n            src={proposal.link_image}\r\n            onError={() => {\r\n              console.warn(\"Image failed to load:\", proposal.link_image);\r\n              setImgError(true);\r\n            }}\r\n            alt={proposal.title}\r\n            className=\"proposal-image\"\r\n          />\r\n        ) : (\r\n          <div className=\"proposal-image fallback-icon\">\r\n            <FaImage size={48} color=\"#aaa\" />\r\n          </div>\r\n        )}\r\n        <h3 className=\"proposal-title\">{proposal.title}</h3>\r\n        <p className=\"proposal-summary\">{proposal.description}</p>\r\n      </div>\r\n\r\n      {/* Flag Button with icon */}\r\n      <button className=\"flag-btn\" onClick={() => setShowFlagModal(true)} disabled={flagged}>\r\n        <>\r\n          <FaFlag style={{ marginRight: \"6px\", color: flagged ? \"red\" : \"#333\" }} />\r\n          {flagged ? \"Flagged\" : \"Flag\"}\r\n        </>\r\n      </button>\r\n\r\n      {/* Modal */}\r\n      {showFlagModal && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-content\">\r\n            <h4>Flag Project</h4>\r\n\r\n            <label>Reason:</label>\r\n            <select value={flagReason} onChange={(e) => setFlagReason(e.target.value)} required>\r\n              <option value=\"\">Select reason</option>\r\n              <option value=\"Inappropriate Content\">Inappropriate Content</option>\r\n              <option value=\"Spam\">Spam</option>\r\n              <option value=\"Other\">Other</option>\r\n            </select>\r\n\r\n            <label>Description (optional):</label>\r\n            <textarea\r\n              value={flagDesc}\r\n              onChange={(e) => setFlagDesc(e.target.value)}\r\n              rows=\"3\"\r\n              placeholder=\"Describe why you're flagging this project...\"\r\n            />\r\n\r\n            <div className=\"modal-actions\">\r\n              <button onClick={handleFlag}>Submit</button>\r\n              <button onClick={() => setShowFlagModal(false)}>Cancel</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </article>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}